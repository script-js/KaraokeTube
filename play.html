<!DOCTYPE html>
<html>

<head>
    <style>
        html, body {
            width: 99%;
            height: 99%;
        }

        #lyrics {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <div id="lyrics"></div>
    <div id="music"></div>
    <script>
        var search = new URLSearchParams(location.search);
        var music = search.get("music");
        var lyrics = search.get("lyrics");
        var musicStartTime = search.get("musicStart");
        var lyricsStartTime = search.get("lyricsStart");

        var tag = document.createElement('script');

        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        var musicPlayer;
        var lyricsPlayer;
        function onYouTubeIframeAPIReady() {
            musicPlayer = new YT.Player('music', {
                videoId: music,
                start: musicStartTime,
                height: '0',
                width: '0',
                playerVars: {
                    'playsinline': 1
                },
                events: {
                    'onStateChange': syncLyricsPlayState
                }

            });
            lyricsPlayer = new YT.Player('lyrics', {
                videoId: lyrics,
                start: lyricsStartTime,
                height: '0',
                width: '0',
                playerVars: {
                    'playsinline': 1
                },
                events: {
                    'onStateChange': syncMusicPlayState
                }
            });
        }

        function syncMusicPlayState(event) {
            switch (event.data) {
                case YT.PlayerState.PLAYING:
                    musicPlayer.playVideo();
                    lyricsPlayer.mute();
                    break;
                case YT.PlayerState.PAUSED:
                    musicPlayer.pauseVideo();
                    break;
                case YT.PlayerState.BUFFERING:
                    musicPlayer.pauseVideo();
                    break;
            }
        }

        function syncLyricsPlayState(event) {
            switch (event.data) {
                case YT.PlayerState.PLAYING:
                    lyricsPlayer.playVideo();
                    break;
                // case YT.PlayerState.CUED:
                //     lyricsPlayer.pauseVideo();
                //     break;
                case YT.PlayerState.BUFFERING:
                    lyricsPlayer.pauseVideo();
                    break;
                case YT.PlayerState.ENDED:
                    lyricsPlayer.stopVideo();
                    break;
            }
        }
    </script>
</body>

</html>